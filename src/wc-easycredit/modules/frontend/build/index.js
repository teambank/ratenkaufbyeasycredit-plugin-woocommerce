jQuery((function(e){const t=e("meta[name=easycredit-widget-selector]").attr("content"),i=e("<easycredit-widget />").attr({"webshop-id":e("meta[name=easycredit-api-key]").attr("content"),amount:e("meta[name=easycredit-widget-price]").attr("content")});e(t).filter((function(){return"hidden"!==e(this).css("visibility")&&0!==e(this).css("opacity")})).first().after(i),e("form.variations_form").on("show_variation",(function(e,t){t.display_price&&i.get(0).setAttribute("amount",t.display_price)})),e(".woocommerce-checkout").on("change","#billing_company",(function(){0!==e(this).closest(".woocommerce-billing-fields").length&&e(this).trigger("update_checkout")}));const n=(e,t)=>{document.querySelector(e)&&window.setTimeout((()=>{if(!document.querySelector(e).classList.contains("hydrated"))return n(e,t);t(e)}),50)},o=(e,t)=>{new window.MutationObserver((i=>{i.forEach((function(i){i.addedNodes.forEach((function(i){if(1!==i.nodeType)return;let n;(n=i.querySelector(e))&&t(e,n)}))}))})).observe(document,{subtree:!0,childList:!0})},s=t=>{n(t,(()=>{e(t).submit((function(t){const i=e(this).closest("form");return i.append('<input type="hidden" name="easycredit[submit]" value="1" />'),i.append('<input type="hidden" name="terms" value="On" />'),i.append('<input type="hidden" name="legal" value="On" />'),t.detail&&t.detail.numberOfInstallments&&i.append('<input type="hidden" name="easycredit[number-of-installments]" value="'+t.detail.numberOfInstallments+'" />'),i.submit(),!1})),e("form.checkout").on("checkout_place_order",(()=>!e("easycredit-checkout").is(":visible")||!e("easycredit-checkout").prop("isActive")||""!==e("easycredit-checkout").prop("paymentPlan")||""!==e("easycredit-checkout").prop("alert")||e(this).find('input[name="easycredit[submit]"]').length>0||(e(t).get(0).dispatchEvent(new Event("openModal")),!1))),e(document.body).on("checkout_error",(()=>{e(t).get(0).dispatchEvent(new Event("closeModal"))}))}))};o("form[name=checkout] easycredit-checkout",s),n("form[name=checkout] easycredit-checkout",s);const r=t=>{e(t).closest(".wc-block-components-express-payment").length>0||n(t,(()=>{e(t).submit((()=>{let t=e(this).closest(".summary").find("form.cart");0===t.length&&(t=e("body").find("form.cart"));const i=document.querySelector('button[name="add-to-cart"], button.single_add_to_cart_button');if(i){const e={"easycredit-express":1};return i.getAttribute("value")&&(e["add-to-cart"]=i.getAttribute("value")),void((e,t)=>{if(!e)return!1;const i=document.createElement("form");i.setAttribute("action",e.getAttribute("action")),i.setAttribute("method",e.getAttribute("method")),i.style.display="none";const n=new FormData(e);for(const e in t)n.set(e,t[e]);for(const e of n.keys()){const t=document.createElement("input");t.setAttribute("name",e),t.setAttribute("value",n.get(e)),i.append(t)}return document.querySelector("body").append(i),i})(t.get(0),e).submit()}e(this).closest(".wc-proceed-to-checkout").length>0?window.location.href=e(this).data("url"):window.alert("Der easyCredit-Ratenkauf konnte nicht gestartet werden.")}))}))},c=e("form.variations_form");c.on("show_variation",((t,i,n)=>{const o=e("easycredit-express-button").show().get(0);o&&o.setAttribute("amount",n&&i.is_in_stock?i.display_price:1)})),c.on("hide_variation",(()=>{e("easycredit-express-button").hide()})),o("easycredit-express-button",r),n("easycredit-express-button",r),(()=>{const e=document.querySelector("easycredit-box-listing.easycredit-box-listing-adjusted");if(e){const i=[...(t=e).parentElement.children].filter((e=>e!==t)),n=i[0].clientWidth,o=i[0].clientHeight,s=i[0].classList;e.style.width=n+"px",e.style.height=o+"px",e.style.visibility="hidden",e.classList=e.classList+" "+s,"LI"===i[0].tagName&&(e.style.display="list-item",e.style.listStyle="none","UL"===e.parentElement.tagName&&(e.parentElement.classList=e.parentElement.classList+" easycredit-card-columns-adjusted"))}var t})(),n("easycredit-box-listing",(()=>{const e=document.querySelector("easycredit-box-listing.easycredit-box-listing-adjusted");e&&(e.shadowRoot.querySelector(".ec-box-listing").style.maxWidth="100%",e.shadowRoot.querySelector(".ec-box-listing").style.height="100%",e.shadowRoot.querySelector(".ec-box-listing__image").style.minHeight="100%",e.style.visibility="")})),(()=>{const e=document.querySelector("easycredit-box-listing");if(e){const i=[...(t=e).parentElement.children].filter((e=>e!==t)),n=e.getAttribute("position"),o=void 0===n?null:Number(n-1),s=void 0===n?null:Number(n-2);!n||o<=0||(s in i?i[s].after(e):e.parentElement.append(e))}var t})()}));